#+title: Gentoo Install(LUKS,BTRFS)
#+author: keke
#+email: liushike1997@gmail.com
#+date: <2020-04-30 Thu>
#+export_file_name: ~/keke-cute.github.io/blog/gentooinstall2.html
#+options: creator:t author:t
* Livecd ğŸ’¿
  [[http://www.system-rescue-cd.org/]]
* åˆ†åŒº ğŸ’¾
  #+BEGIN_SRC bash
    â¯ lsblk
    NAME     MAJ:MIN RM  SIZE RO TYPE  MOUNTPOINT
    sda        8:0    0  477G  0 disk
    â””â”€sda1     8:1    0  477G  0 part
      â””â”€root 254:0    0  477G  0 crypt /
    â¯ fdisk /dev/sda1
    o å»ºç«‹æ–°çš„dosåˆ†åŒºè¡¨
    n å»ºç«‹æ–°çš„åˆ†åŒº
    w å†™å…¥åˆ†åŒºè¡¨
  #+END_SRC
* ä½¿ç”¨luksåŠ å¯†è¯¥åˆ†åŒº ğŸ”
  #+begin_src bash
    â¯ cryptsetup -s 512 luksFormat /dev/sda1
    This will overwrite data on /dev/sda1 irrevocably.

    Are you sure? (Type uppercase yes): YES
    Enter LUKS passphrase: ...
    Verify passphrase: ...
  #+end_src
  å¤‡ä»½luksæ ‡å¤´æ–‡ä»¶ï¼Œå¿˜è®°å¯†ç çš„æ—¶å€™å¯ä»¥æ¢å¤ğŸ“ƒ
  #+begin_src bash
    â¯ cryptsetup luksHeaderBackup /dev/sda1 --header-backup-file /path/to/you/want/luks-header.img
  #+end_src
* æ‰“å¼€åŠ å¯†è¿‡çš„åˆ†åŒºå¹¶æ ¼å¼åŒ–ä¸ºbtrfsæ–‡ä»¶ç³»ç»Ÿ ğŸ“ƒ
  #+begin_src bash
    â¯ cryptsetup luksOpen /dev/sda1 root
    Enter passphrase for /dev/sda1: ...
  #+end_src
  æ ¼å¼åŒ–å¹¶æŒ‚è½½
  #+begin_src bash
    â¯ mkfs.btrfs /dev/mapper/root
      mkdir /mnt/gentoo
      mount /dev/mapper/root /mnt/gentoo
      cd /mnt/gentoo
  #+end_src
